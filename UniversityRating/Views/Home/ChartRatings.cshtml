@{
    ViewData["Title"] = "University Rankings";
}

@model List<UniversityRating.Models.IndicatorVM>
@{
    List<int> predictValues = new List<int>();
    var srendn = Model.Sum(x => x.Value) / Model.Count;
    int sum = 0;
    for (int i = 0; i < Model.Count; i++)
    {
        sum += Model[i].Value;
        predictValues.Add(sum / (i + 1));
    }
}
<div class="text-center">
    <h2 class="display-5">Графики изменения показателя во времени и прогноза</h2>
    <h3 class="display-5">Наименование показателя</h3>
    <h3 class="display-5">@Model[0].IndicatorName</h3>
</div>
<div id="mychart" style="width: 900px; height: 500px"></div>
@section Scripts{
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Year', 'Статистические значения', 'Прогнозируемые значения'],
                @foreach (var data in Model) {
                    @foreach (var predict in predictValues)
                        {
                            <text>['@data.Year', @data.Value, @predict],</text>
                        }
                    }
            ]);

            @*function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Year', 'Rating'],
                @for (var i = 0; i < Model.Count; i++) {
                     <text>['@Model[i].Year', @Model[i].Value],</text>
                }
            ]);*@



           //var data = google.visualization.arrayToDataTable([
           //    ['Year', 'Rating'],
           //    ['2004', 1000],
           //    ['2005', 1000],
           //    ['2006', 1000],
           //    ['2007', 1000]
           // ]);

            var options = {
                title: 'Изменение показателя вуза во времени',
                curveType: 'function',
                legend: { position: 'bottom' }
            };

            var chart = new google.visualization.LineChart(document.getElementById('mychart'));

            chart.draw(data, options);
        }
    </script>
}
